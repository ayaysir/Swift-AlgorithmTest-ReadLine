//
//  14889.swift
//  AlgorithmTest-ReadLine
//
//  Created by ìœ¤ë²”íƒœ on 3/16/24.
//

// import Foundation

func Q_14889() {
    let n = Int(readLine()!)!
    var matrix = [[Int]]()
    for _ in 0..<n {
        matrix.append(readLine()!.split(separator: " ").map { Int($0)! })
    }
    
    let totalMembers = [Int](0..<n)
    var startMembers = [0] // 0ë²ˆ ì‚¬ëŒì€ start íŒ€ ê³ ì •
    var minDiff: Int = .max
    
    /// íŠ¹ì • team ë©¤ë²„ë“¤ë¼ë¦¬ì˜ í•©ì„ matrixì—ì„œ ì°¾ì•„ ê³„ì‚° ë° ë°˜í™˜
    /// - ì´ì¤‘ forë¬¸ìœ¼ë¡œ ê°™ì€ íŒ€ ë©¤ë²„ë“¤ë¼ë¦¬ ì¡°í•©
    /// - iì™€ jê°€ ê°™ì€ ê²½ìš° 0ì´ë¯€ë¡œ ë”í•˜ë”ë¼ë„ ì˜í–¥ ì—†ìŒ
    func sum(_ team: [Int]) -> Int {
        var sum = 0
        for i in 0..<team.count {
            for j in 0..<team.count {
                sum += matrix[team[i]][team[j]]
            }
        }
        
        return sum
    }
    
    /// xëŠ” í˜„ì¬ ì¸ë±ìŠ¤, depthëŠ” ??
    /// - depth ì ˆë°˜ê¹Œì§€ ì˜¨ ê²½ìš° íŒ€ì„ ë¶„í• í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì°¨ì´ ê³„ì‚°
    func backtracking(_ x: Int = 0, _ depth: Int = 1) {
        if depth == n / 2 {
            let linkMembers = totalMembers.filter { !startMembers.contains($0) }
            let (startSum, linkSum) = (sum(startMembers), sum(linkMembers))
            
            minDiff = min(minDiff, abs(startSum - linkSum))
            return // ì—†ì–´ë„ ê²°ê³¼ ë˜‘ê°™ìŒ (backtrackingì„ ë”ì´ìƒ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ)
        }
        
        // [ğŸ’¥ğŸ’¥ğŸ’¥] xê°€ ì•„ë‹ˆë¼ x+1ë¶€í„° ì‹œì‘
        // 8ëª…ì¸ ê²½ìš° i = [a(=>x+1), b(=>y+1), c(=>z+1)], depth = [1, 2, 3, 4(ì¢…ë£Œ íŠ¸ë¦¬ê±°)]
        // 0ë²ˆì€ startíŒ€ ê³ ì •ì´ë¯€ë¡œ 4:4ë¡œ ë¶„í• ë¨
        for i in (x + 1)..<n  {
            startMembers.append(i)
            backtracking(i, depth + 1)
            startMembers.removeLast()
        }
    }
    
    backtracking()
    print(minDiff)
}

/*
[í’€ì´] https://www.acmicpc.net/source/73271716

-------------------------

ìŠ¤íƒ€íŠ¸ì™€ ë§í¬ https://www.acmicpc.net/problem/14889

ë¬¸ì œ
ì˜¤ëŠ˜ì€ ìŠ¤íƒ€íŠ¸ë§í¬ì— ë‹¤ë‹ˆëŠ” ì‚¬ëŒë“¤ì´ ëª¨ì—¬ì„œ ì¶•êµ¬ë¥¼ í•´ë³´ë ¤ê³  í•œë‹¤. ì¶•êµ¬ëŠ” í‰ì¼ ì˜¤í›„ì— í•˜ê³  ì˜ë¬´ ì°¸ì„ë„ ì•„ë‹ˆë‹¤. ì¶•êµ¬ë¥¼ í•˜ê¸° ìœ„í•´ ëª¨ì¸ ì‚¬ëŒì€ ì´ Nëª…ì´ê³  ì‹ ê¸°í•˜ê²Œë„ Nì€ ì§ìˆ˜ì´ë‹¤. ì´ì œ N/2ëª…ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ìŠ¤íƒ€íŠ¸ íŒ€ê³¼ ë§í¬ íŒ€ìœ¼ë¡œ ì‚¬ëŒë“¤ì„ ë‚˜ëˆ ì•¼ í•œë‹¤.

BOJë¥¼ ìš´ì˜í•˜ëŠ” íšŒì‚¬ ë‹µê²Œ ì‚¬ëŒì—ê²Œ ë²ˆí˜¸ë¥¼ 1ë¶€í„° Nê¹Œì§€ë¡œ ë°°ì •í–ˆê³ , ì•„ë˜ì™€ ê°™ì€ ëŠ¥ë ¥ì¹˜ë¥¼ ì¡°ì‚¬í–ˆë‹¤. ëŠ¥ë ¥ì¹˜ SijëŠ” ië²ˆ ì‚¬ëŒê³¼ jë²ˆ ì‚¬ëŒì´ ê°™ì€ íŒ€ì— ì†í–ˆì„ ë•Œ, íŒ€ì— ë”í•´ì§€ëŠ” ëŠ¥ë ¥ì¹˜ì´ë‹¤. íŒ€ì˜ ëŠ¥ë ¥ì¹˜ëŠ” íŒ€ì— ì†í•œ ëª¨ë“  ìŒì˜ ëŠ¥ë ¥ì¹˜ Sijì˜ í•©ì´ë‹¤. SijëŠ” Sjiì™€ ë‹¤ë¥¼ ìˆ˜ë„ ìˆìœ¼ë©°, ië²ˆ ì‚¬ëŒê³¼ jë²ˆ ì‚¬ëŒì´ ê°™ì€ íŒ€ì— ì†í–ˆì„ ë•Œ, íŒ€ì— ë”í•´ì§€ëŠ” ëŠ¥ë ¥ì¹˜ëŠ” Sijì™€ Sjiì´ë‹¤.

N=4ì´ê³ , Sê°€ ì•„ë˜ì™€ ê°™ì€ ê²½ìš°ë¥¼ ì‚´í´ë³´ì.

i\j |  1    2    3    4
---------------------------
1  |  .    1    2    3
2  |  4    .    5    6
3  |  7    1    .    2
4  |  3    4    5    .

ì˜ˆë¥¼ ë“¤ì–´, 1, 2ë²ˆì´ ìŠ¤íƒ€íŠ¸ íŒ€, 3, 4ë²ˆì´ ë§í¬ íŒ€ì— ì†í•œ ê²½ìš°ì— ë‘ íŒ€ì˜ ëŠ¥ë ¥ì¹˜ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

ìŠ¤íƒ€íŠ¸ íŒ€: S(12) + S(21) = 1 + 4 = 5
ë§í¬ íŒ€: S(34) + S(43) = 2 + 5 = 7
1, 3ë²ˆì´ ìŠ¤íƒ€íŠ¸ íŒ€, 2, 4ë²ˆì´ ë§í¬ íŒ€ì— ì†í•˜ë©´, ë‘ íŒ€ì˜ ëŠ¥ë ¥ì¹˜ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

ìŠ¤íƒ€íŠ¸ íŒ€: S(13) + S(31) = 2 + 7 = 9
ë§í¬ íŒ€: S(24) + S(42) = 6 + 4 = 10
ì¶•êµ¬ë¥¼ ì¬ë¯¸ìˆê²Œ í•˜ê¸° ìœ„í•´ì„œ ìŠ¤íƒ€íŠ¸ íŒ€ì˜ ëŠ¥ë ¥ì¹˜ì™€ ë§í¬ íŒ€ì˜ ëŠ¥ë ¥ì¹˜ì˜ ì°¨ì´ë¥¼ ìµœì†Œë¡œ í•˜ë ¤ê³  í•œë‹¤. ìœ„ì˜ ì˜ˆì œì™€ ê°™ì€ ê²½ìš°ì—ëŠ” 1, 4ë²ˆì´ ìŠ¤íƒ€íŠ¸ íŒ€, 2, 3ë²ˆ íŒ€ì´ ë§í¬ íŒ€ì— ì†í•˜ë©´ ìŠ¤íƒ€íŠ¸ íŒ€ì˜ ëŠ¥ë ¥ì¹˜ëŠ” 6, ë§í¬ íŒ€ì˜ ëŠ¥ë ¥ì¹˜ëŠ” 6ì´ ë˜ì–´ì„œ ì°¨ì´ê°€ 0ì´ ë˜ê³  ì´ ê°’ì´ ìµœì†Œì´ë‹¤.

ì…ë ¥
ì²«ì§¸ ì¤„ì— N(4 â‰¤ N â‰¤ 20, Nì€ ì§ìˆ˜)ì´ ì£¼ì–´ì§„ë‹¤. ë‘˜ì§¸ ì¤„ë¶€í„° Nê°œì˜ ì¤„ì— Sê°€ ì£¼ì–´ì§„ë‹¤. ê° ì¤„ì€ Nê°œì˜ ìˆ˜ë¡œ ì´ë£¨ì–´ì ¸ ìˆê³ , ië²ˆ ì¤„ì˜ jë²ˆì§¸ ìˆ˜ëŠ” S(ij) ì´ë‹¤. S(ii)ëŠ” í•­ìƒ 0ì´ê³ , ë‚˜ë¨¸ì§€ S(ij)ëŠ” 1ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ê³ , 100ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì€ ì •ìˆ˜ì´ë‹¤.

ì¶œë ¥
ì²«ì§¸ ì¤„ì— ìŠ¤íƒ€íŠ¸ íŒ€ê³¼ ë§í¬ íŒ€ì˜ ëŠ¥ë ¥ì¹˜ì˜ ì°¨ì´ì˜ ìµœì†Ÿê°’ì„ ì¶œë ¥í•œë‹¤.

ì˜ˆì œ ì…ë ¥ 1
4
0 1 2 3
4 0 5 6
7 1 0 2
3 4 5 0
ì˜ˆì œ ì¶œë ¥ 1
0

ì˜ˆì œ ì…ë ¥ 2
6
0 1 2 3 4 5
1 0 2 3 4 5
1 2 0 3 4 5
1 2 3 0 4 5
1 2 3 4 0 5
1 2 3 4 5 0
ì˜ˆì œ ì¶œë ¥ 2
2

ì˜ˆì œ ì…ë ¥ 3
8
0 5 4 5 4 5 4 5
4 0 5 1 2 3 4 5
9 8 0 1 2 3 1 2
9 9 9 0 9 9 9 9
1 1 1 1 0 1 1 1
8 7 6 5 4 0 3 2
9 1 9 1 9 1 0 9
6 5 4 3 2 1 9 0
ì˜ˆì œ ì¶œë ¥ 3
1

íŒíŠ¸
ì˜ˆì œ 2ì˜ ê²½ìš°ì— (1, 3, 6), (2, 4, 5)ë¡œ íŒ€ì„ ë‚˜ëˆ„ë©´ ë˜ê³ , ì˜ˆì œ 3ì˜ ê²½ìš°ì—ëŠ” (1, 2, 4, 5), (3, 6, 7, 8)ë¡œ íŒ€ì„ ë‚˜ëˆ„ë©´ ëœë‹¤.

*/
