//
//  2618.swift
//  AlgorithmTest-ReadLine
//
//  Created by ìœ¤ë²”íƒœ on 4/8/2024.
//
//  5: ê²½ì°°ì°¨ https://www.acmicpc.net/problem/2618
//

import Foundation

/// ê²½ì°°ì°¨ https://www.acmicpc.net/problem/2618
func Q_2618() {
    let n = Int(readLine()!)!
    let w = Int(readLine()!)!
    /// ì‚¬ê±´ì´ ë°œìƒëœ ì§€ì  ëª©ë¡
    let p: [(y: Int, x: Int)] = (0..<w).map { _ in
        let r = readLine()!.split(separator: " ").map { Int($0)! }
        return (y: r[0], x: r[1])
    }
    
    var dp = Array(repeating: Array(repeating: -1, count: w + 2), count: w + 2)
    var paths = Array(repeating: Array(repeating: -1, count: w + 2), count: w + 2)
    
    func calculateDistance(police: Int, target: Int, start: Int) -> Int {
        var policePos = (y: 0, x: 0)
        var targetPos = (y: 0, x: 0)
        
        if start == 1 {
            policePos = (1, 1)
        } else if start == 2 {
            policePos = (n, n)
        } else {
            policePos = p[police - 1]
        }
        
        targetPos = p[target - 1]
        
        return abs(policePos.y - targetPos.y) + abs(policePos.x - targetPos.x)
    }
    
    /// 1: ìµœì†Œ ê±°ë¦¬ ì°¾ê¸°
    func findDistance(p1: Int, p2: Int) -> Int {
        guard p1 < w, p2 < w else {
            return 0
        }
        
        guard dp[p1][p2] == -1 else {
            return dp[p1][p2]
        }
        
        let move = max(p1, p2) + 1
        
        var (nextP1Dist, nextP2Dist) = (0, 0)
        nextP1Dist = findDistance(p1: move, p2: p2) + calculateDistance(police: p1, target: move, start: p1 == 0 ? 1 : 0)
        nextP2Dist = findDistance(p1: p1, p2: move) + calculateDistance(police: p2, target: move, start: p2 == 0 ? 2 : 0)
        
        dp[p1][p2] = min(nextP1Dist, nextP2Dist)
        paths[p1][p2] = nextP1Dist < nextP2Dist ? 1 : 2
        
        return min(nextP1Dist, nextP2Dist)
    }
    
    print(findDistance(p1: 0, p2: 0))
    
    // 2: ê²½ë¡œ êµ¬í•˜ê¸°
    var (x, y) = (0, 0)
    var pathResult = ""
    
    for i in 0..<w {
        pathResult.write("\(paths[x][y])\n")
        
        if paths[x][y] == 1 {
            x = i + 1
        } else {
            y = i + 1
        }
    }
    
    print(pathResult)
}

/*
 [í’€ì´] https://source-sc.tistory.com/53
 (1) DFS + DPë¥¼ ì´ìš©í•´ ìµœì†Œ ê±°ë¦¬ ê³„ì‚°
 (2) ì‚°ì¶œë¬¼ì¸ PATHS í…Œì´ë¸”ì„ ì´ìš©í•´ ê²½ì°°ì´ ë§¡ì€ ì‚¬ê±´ (ê²½ë¡œ) ì¶œë ¥
 
 [ë¬¸ì œ ì˜ˆì œë¥¼ í†µí•œ ë¶„ì„]
 â¬œï¸1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£
 1ï¸âƒ£ğŸš”â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 2ï¸âƒ£â¬œï¸â¬œï¸ğŸ’¥â¬œï¸â¬œï¸â¬œï¸
 3ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸ’¥â¬œï¸
 4ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 5ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸ’¥â¬œï¸
 6ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸš”
 - ê²½ì°°ì°¨ëŠ” (1, 1) ê·¸ë¦¬ê³  (6, 6)ì— ìœ„ì¹˜í•´ìˆê³ 
 - 3ê°œì˜ ì‚¬ê±´ì´ ë¶„í¬ë˜ì–´ìˆë‹¤. 1:(3, 5) 2:(5, 5) 3:(2, 3)
 
 (1) ì²«ë²ˆì§¸ ì‚¬ê±´ì˜ ì²˜ë¦¬
  - 1ë²ˆ ê²½ì°°ì°¨ê°€ 6ì¹¸ì„ ì´ë™í•˜ì—¬ ì²˜ë¦¬í•˜ê±°ë‚˜
  - 2ë²ˆ ê²½ì°°ì°¨ê°€ 4ì¹¸ì„ ì´ë™í•˜ì—¬ ì²˜ë¦¬
 â¬œï¸1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£        â¬œï¸1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£
 1ï¸âƒ£ğŸš”ğŸŸ§ğŸŸ§ğŸŸ§ğŸŸ§â¬œï¸        1ï¸âƒ£ğŸš”â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 2ï¸âƒ£â¬œï¸â¬œï¸ğŸ’¥â¬œï¸ğŸŸ§â¬œï¸        2ï¸âƒ£â¬œï¸â¬œï¸ğŸ’¥â¬œï¸â¬œï¸â¬œï¸
 3ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸âœ´ï¸â¬œï¸        3ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸âœ´ï¸ğŸŸ§
 4ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸        4ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸŸ§
 5ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸ’¥â¬œï¸        5ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸ’¥ğŸŸ§
 6ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸš”        6ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸš”
 
 ë¸Œë£¨íŠ¸í¬ìŠ¤ë¡œ ì²˜ë¦¬ì‹œ 2^w: w = 1000ì¸ ê²½ìš° 2^1000ìœ¼ë¡œ ë¶ˆê°€
 
 (2) DP ì‚¬ìš©
 ë§Œì•½ DPë¥¼ ì‚¬ìš©í•´ì„œ 10ë²ˆê¹Œì§€ì˜ ì‚¬ê±´ ì¤‘ 5ë²ˆê¹Œì§€ë§Œ ì‚¬ê±´ íŒŒì•…ì´ ë˜ì—ˆê³  ë‚˜ë¨¸ì§€ëŠ” ë°°ì •ì´ ë˜ì§€ ì•Šì•˜ë‹¤ë©´
 â¬œï¸1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£ğŸ”Ÿ
 1ï¸âƒ£âœ”ï¸âœ”ï¸â¬œï¸âœ”ï¸âœ…
 2ï¸âƒ£â¬œï¸â¬œï¸âœ…â¬œï¸â¬œï¸
 - (1~5)ë²ˆê¹Œì§€ì˜ ê²½ìš°ì˜ ìˆ˜ 2^5, (6~10)ë²ˆë„ ê²½ìš°ì˜ ìˆ˜ 2^5
 - ê°€ì¥ ì¤‘ìš”í•œ í¬ì¸íŠ¸ì¤‘ í•˜ë‚˜ëŠ” í˜„ì¬ ì§„í–‰ ìƒíƒœë¥¼ ê° ê²½ì°°ì°¨ë“¤ì˜ ë§ˆì§€ë§‰ìœ¼ë¡œ ë§¡ì€ ì‚¬ê±´ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.
   - 1,2,4,5 ë²ˆì‚¬ê±´ì„ 1ë²ˆ ê²½ì°°ì°¨ê°€, 3ë²ˆ ì‚¬ê±´ì„ 2ë²ˆ ê²½ì°°ì°¨ê°€ ë‹´ë‹¹
 - 1ë²ˆê³¼ 2ë²ˆì˜ ê²°ê³¼ ê²½ìš°ì˜ ìˆ˜ë¥¼ ì•Œì•„ë³´ë©´ 2^2 = 4 ê°€ì§€ê°€ ë‚˜ì˜¨ë‹¤.
   - ê·¸ëŸ¬ë‚˜ ê·¸ ê²°ê³¼ ëª¨ë‘ 5ë²ˆê¹Œì§€ ë´¤ì„ ë•Œ ê²½ì°°ì°¨ 1, 2ê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ë§¡ì€ ì‚¬ê±´ì€ ë™ì¼í•˜ë‹¤. (ì´ˆë¡ ì²´í¬ë°•ìŠ¤)
   - ì¦‰, 1ë²ˆê³¼ 2ë²ˆì˜ ê²°ê³¼ê°€ ì–´ì°Œë˜ë”ë¼ë„ ì´í›„ 6~10ê¹Œì§€ì˜ ê²°ê³¼ê°’ì€ ëª¨ë‘ ë™ì¼í•  ê²ƒì´ë¯€ë¡œ 4ë²ˆ ëª¨ë‘ ì‹œí–‰í•´ ë³¼ í•„ìš”ê°€ ì—†ë‹¤.
 - ë”°ë¼ì„œ 2ì°¨ì› ë°°ì—´ë¡œ ê° ê²½ì°°ì°¨ë“¤ì˜ ìµœì¢… ì‚¬ê±´ì„ íŒŒë¼ë¯¸í„°ë¡œ ìµœì†Œê°’ì„ ì €ì¥í•˜ì—¬ DFSì—ì„œ DPë¥¼ ì„¤ê³„í•œë‹¤.
 
 (3) ê²½ë¡œ ì¶”ì 
 - ë§Œì•½ ìœ„ì˜ DPë¥¼ í™œìš©í•˜ì—¬ ìµœì†Ÿê°’ê³¼ í•´ë‹¹ ì‚¬ê±´ ì²˜ë¦¬ ê²°ê³¼ë¥¼ stringì´ë‚˜ ë‹¤ë¥¸ í˜•íƒœë¡œ ì €ì¥í•œë‹¤ê³  í•´ë„
    w^3 = 1000^3 ë°”ì´íŠ¸ë§Œí¼ì˜ ë©”ëª¨ë¦¬ë¥¼ ìš”êµ¬í•˜ë©° 128mbì¸ ë¬¸ì œì˜ ë©”ëª¨ë¦¬ ì¡°ê±´ì„ ë›°ì–´ë„˜ê²Œ ë ê²ƒì´ë‹¤.
 - í˜„ì¬ ê²½ì°°ì°¨ë“¤ì˜ ë§ˆì§€ë§‰ ì‚¬ê±´ë²ˆí˜¸ë¥¼ í†µí•´ í•´ë‹¹ ì‚¬ê±´ë²ˆí˜¸ì¼ ë•Œ ì´í›„ì— ìµœì†Œê±°ë¦¬ë¥¼ ë§Œë“¤ìˆ˜ ìˆëŠ” ê²½ì°°ì°¨ë¥¼ ê¸°ë¡í•œë‹¤.
 
 ì˜ˆ) ì‚¬ê±´ì€ ì´ 4ê°œì´ë©°
  - í˜„ì¬ê¹Œì§€ 1ë²ˆ ì‚¬ê±´ì„ 1ë²ˆ ê²½ì°°ì°¨ê°€, 2ë²ˆ ì‚¬ê±´ì„ 2ë²ˆ ê²½ì°°ì°¨ê°€ ìˆ˜í–‰í–ˆë‹¤ê³  ê°€ì •í•  ë•Œ,
  - ì´í›„ 2ë²ˆ ê²½ì°°ì°¨ê°€ 3ë²ˆ ì‚¬ê±´ì„ ë‹´ë‹¹í•˜ëŠ” ê²ƒì´ ìµœì†Œê±°ë¦¬ë¥¼ ë§Œë“ ë‹¤ê³  í•˜ë©´
  - (1,2) ì§€ì ì˜ ê°’ì€ 2(ğŸš¨)ê°€ ëœë‹¤.
 
 â¬œï¸1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£
 1ï¸âƒ£â¬œï¸ğŸš¨â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 2ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 3ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 4ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 5ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 6ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 í•´ë‹¹ ì§€ì ì—ëŠ” ë‹¤ìŒ ì‚¬ê±´ì„ ë‹´ë‹¹í•´ì•¼ í•  ê²½ì°°ì°¨ì˜ ë²ˆí˜¸ê°€ ë“¤ì–´ê°€ì•¼í•œë‹¤.
 
 â¬œï¸1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£
 1ï¸âƒ£âœ”ï¸â¬œï¸â¬œï¸â¬œï¸
 2ï¸âƒ£â¬œï¸âœ”ï¸âœ…â¬œï¸
 
 ê·¸ë¦¬ê³  3ë²ˆ ì‚¬ê±´ì„ 2ë²ˆ ê²½ì°°ì°¨ê°€ ë‹´ë‹¹í•œ í›„ 4ë²ˆì§¸ ì‚¬ê±´ì„ ë‹´ë‹¹í•´ì•¼ í•  ê²½ì°°ì°¨ì˜ ë²ˆí˜¸ê°€ (1,3) ì§€ì ì— ë“¤ì–´ê°€ì•¼í•œë‹¤.
 - (1, 3) ì§€ì ì˜ ê°’ì€ 1 (ğŸš“)ì´ ëœë‹¤.
 â¬œï¸1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£
 1ï¸âƒ£â¬œï¸â¬œï¸ğŸš“â¬œï¸â¬œï¸â¬œï¸
 2ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 3ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 4ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 5ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 6ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 
 â¬œï¸1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£
 1ï¸âƒ£âœ”ï¸â¬œï¸â¬œï¸âœ…
 2ï¸âƒ£â¬œï¸âœ”ï¸âœ”ï¸â¬œï¸
 
 - DFSë¥¼ í†µí•´ ë¿Œë¦¬ê¹Œì§€ íƒìƒ‰í•˜ëŠ” ë™ì•ˆ minimum ê°’ì´ ë„ì¶œë  ë•Œë§ˆë‹¤
 - í˜„ì¬ ê²½ì°°ì°¨ë“¤ì˜ ë§ˆì§€ë§‰ ë‹´ë‹¹ ì‚¬ê±´ ë²ˆí˜¸ 2ê°€ì§€ë¡œ ì´í›„ ë‹¤ìŒ ì‚¬ê±´ì„ ë‹´ë‹¹í•´ì•¼ í•  ê²½ì°°ì°¨ì˜ ë²ˆí˜¸ë¥¼ ë„£ìŒìœ¼ë¡œì¨
 - ìµœì¢…ì ìœ¼ë¡œ ëª¨ë“  ì‚¬ê±´ì˜ ë‹´ë‹¹ ê²½ì°°ì°¨ ìˆœì„œë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.
 
 -------
 
 ë¬¸ì œ
 ì–´ë–¤ ë„ì‹œì˜ ì¤‘ì‹¬ê°€ëŠ” Nê°œì˜ ë™ì„œë°©í–¥ ë„ë¡œì™€ Nê°œì˜ ë‚¨ë¶ë°©í–¥ ë„ë¡œë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.

 ëª¨ë“  ë„ë¡œì—ëŠ” ë„ë¡œ ë²ˆí˜¸ê°€ ìˆìœ¼ë©° ë‚¨ë¶ë°©í–¥ ë„ë¡œëŠ” ì™¼ìª½ë¶€í„° 1ì—ì„œ ì‹œì‘í•˜ì—¬ Nê¹Œì§€ ë²ˆí˜¸ê°€ í• ë‹¹ë˜ì–´ ìˆê³  ë™ì„œë°©í–¥ ë„ë¡œëŠ” ìœ„ë¶€í„° 1ì—ì„œ ì‹œì‘í•˜ì—¬ Nê¹Œì§€ ë²ˆí˜¸ê°€ í• ë‹¹ë˜ì–´ ìˆë‹¤. ë˜í•œ ë™ì„œë°©í–¥ ë„ë¡œ ì‚¬ì´ì˜ ê±°ë¦¬ì™€ ë‚¨ ë¶ë°©í–¥ ë„ë¡œ ì‚¬ì´ì˜ ê±°ë¦¬ëŠ” ëª¨ë‘ 1ì´ë‹¤. ë™ì„œë°©í–¥ ë„ë¡œì™€ ë‚¨ë¶ë°©í–¥ ë„ë¡œê°€ êµì°¨í•˜ëŠ” êµì°¨ë¡œì˜ ìœ„ì¹˜ëŠ” ë‘ ë„ë¡œì˜ ë²ˆí˜¸ì˜ ìŒì¸ (ë™ì„œë°©í–¥ ë„ë¡œ ë²ˆí˜¸, ë‚¨ë¶ë°©í–¥ ë„ë¡œ ë²ˆí˜¸)ë¡œ ë‚˜íƒ€ë‚¸ë‹¤. Nì´ 6ì¸ ê²½ìš°ì˜ ì˜ˆë¥¼ ë“¤ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

 â¬œï¸1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£
 1ï¸âƒ£ğŸš”â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 2ï¸âƒ£â¬œï¸â¬œï¸ğŸ’¥â¬œï¸â¬œï¸â¬œï¸
 3ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸ’¥â¬œï¸
 4ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸
 5ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸ’¥â¬œï¸
 6ï¸âƒ£â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸ğŸš”

 ì´ ë„ì‹œì—ëŠ” ë‘ ëŒ€ì˜ ê²½ì°°ì°¨ê°€ ìˆìœ¼ë©° ë‘ ì°¨ë¥¼ ê²½ì°°ì°¨1ê³¼ ê²½ì°°ì°¨2ë¡œ ë¶€ë¥¸ë‹¤. ì²˜ìŒì—ëŠ” í•­ìƒ ê²½ì°°ì°¨1ì€ (1, 1)ì˜ ìœ„ì¹˜ì— ìˆê³  ê²½ì°°ì°¨2ëŠ” (N, N)ì˜ ìœ„ì¹˜ì— ìˆë‹¤. ê²½ì°° ë³¸ë¶€ì—ì„œëŠ” ì²˜ë¦¬í•  ì‚¬ê±´ì´ ìˆìœ¼ë©´ ê·¸ ì‚¬ê±´ì´ ë°œìƒëœ ìœ„ì¹˜ë¥¼ ë‘ ëŒ€ì˜ ê²½ì°°ì°¨ ì¤‘ í•˜ë‚˜ì— ì•Œë ¤ ì£¼ê³ , ì—°ë½ ë°›ì€ ê²½ì°°ì°¨ëŠ” ê·¸ ìœ„ì¹˜ë¡œ ê°€ì¥ ë¹ ë¥¸ ê¸¸ì„ í†µí•´ ì´ë™í•˜ì—¬ ì‚¬ê±´ì„ ì²˜ë¦¬í•œë‹¤. (í•˜ë‚˜ì˜ ì‚¬ê±´ì€ í•œ ëŒ€ì˜ ê²½ì°°ì°¨ê°€ ì²˜ë¦¬í•œë‹¤.) ê·¸ë¦¬ê³  ì‚¬ê±´ì„ ì²˜ë¦¬ í•œ ê²½ì°°ì°¨ëŠ” ê²½ì°° ë³¸ë¶€ë¡œë¶€í„° ë‹¤ìŒ ì—°ë½ì´ ì˜¬ ë•Œê¹Œì§€ ì²˜ë¦¬í•œ ì‚¬ê±´ì´ ë°œìƒí•œ ìœ„ì¹˜ì—ì„œ ê¸°ë‹¤ë¦°ë‹¤. ê²½ì°° ë³¸ë¶€ì—ì„œëŠ” ì‚¬ê±´ì´ ë°œìƒí•œ ìˆœì„œëŒ€ë¡œ ë‘ ëŒ€ì˜ ê²½ì°°ì°¨ì— ë§¡ê¸°ë ¤ê³  í•œë‹¤. ì²˜ë¦¬í•´ì•¼ ë  ì‚¬ê±´ë“¤ì€ í•­ìƒ êµì°¨ë¡œì—ì„œ ë°œìƒí•˜ë©° ê²½ì°° ë³¸ë¶€ì—ì„œëŠ” ì´ëŸ¬í•œ ì‚¬ê±´ë“¤ì„ ë‚˜ëˆ„ì–´ ë‘ ëŒ€ì˜ ê²½ì°°ì°¨ì— ë§¡ê¸°ë˜, ë‘ ëŒ€ì˜ ê²½ì°°ì°¨ë“¤ì´ ì´ë™í•˜ëŠ” ê±°ë¦¬ì˜ í•©ì„ ìµœì†Œí™” í•˜ë„ë¡ ì‚¬ê±´ì„ ë§¡ê¸°ë ¤ê³  í•œë‹¤.

 ì˜ˆë¥¼ ë“¤ì–´ ì•ì˜ ê·¸ë¦¼ì²˜ëŸ¼ N=6ì¸ ê²½ìš°, ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ì‚¬ê±´ë“¤ì´ 3ê°œ ìˆê³  ê·¸ ì‚¬ê±´ë“¤ì´ ë°œìƒëœ ìœ„ì¹˜ ë¥¼ ìˆœì„œëŒ€ë¡œ (3, 5), (5, 5), (2, 3)ì´ë¼ê³  í•˜ì. (3, 5)ì˜ ì‚¬ê±´ì„ ê²½ì°°ì°¨2ì— ë§¡ê¸°ê³  (5, 5)ì˜ ì‚¬ê±´ë„ ê²½ì°°ì°¨2ì— ë§¡ê¸°ë©°, (2, 3)ì˜ ì‚¬ê±´ì„ ê²½ì°°ì°¨1ì— ë§¡ê¸°ë©´ ë‘ ì°¨ê°€ ì´ë™í•œ ê±°ë¦¬ì˜ í•©ì€ 4 + 2 + 3 = 9ê°€ ë˜ ê³ , ë” ì´ìƒ ì¤„ì¼ ìˆ˜ëŠ” ì—†ë‹¤.

 ì²˜ë¦¬í•´ì•¼ í•  ì‚¬ê±´ë“¤ì´ ìˆœì„œëŒ€ë¡œ ì£¼ì–´ì§ˆ ë•Œ, ë‘ ëŒ€ì˜ ê²½ì°°ì°¨ê°€ ì´ë™í•˜ëŠ” ê±°ë¦¬ì˜ í•©ì„ ìµœì†Œí™” í•˜ë„ë¡ ì‚¬ê±´ë“¤ì„ ë§¡ê¸°ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ì‹œì˜¤.

 ì…ë ¥
 ì²«ì§¸ ì¤„ì—ëŠ” ë™ì„œë°©í–¥ ë„ë¡œì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜ N(5 â‰¤ N â‰¤ 1,000)ì´ ì£¼ì–´ì§„ë‹¤. ë‘˜ì§¸ ì¤„ì—ëŠ” ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ì‚¬ê±´ì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜ W(1 â‰¤ W â‰¤ 1,000)ê°€ ì£¼ì–´ì§„ë‹¤. ì…‹ì§¸ ì¤„ë¶€í„° (W+2)ë²ˆì§¸ ì¤„ê¹Œì§€ ì‚¬ê±´ì´ ë°œìƒëœ ìœ„ì¹˜ê°€ í•œ ì¤„ì— í•˜ë‚˜ì”© ì£¼ì–´ì§„ë‹¤. ê²½ì°°ì°¨ë“¤ì€ ì´ ì‚¬ê±´ë“¤ì„ ì£¼ì–´ì§„ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•´ì•¼ í•œë‹¤. ê° ìœ„ì¹˜ëŠ” ë™ì„œë°©í–¥ ë„ë¡œ ë²ˆí˜¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜ì™€ ë‚¨ë¶ë°©í–¥ ë„ë¡œ ë²ˆí˜¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜ë¡œ ì£¼ì–´ì§€ë©° ë‘ ì •ìˆ˜ ì‚¬ì´ì—ëŠ” ë¹ˆì¹¸ì´ í•˜ë‚˜ ìˆë‹¤. ë‘ ì‚¬ê±´ì´ ë°œìƒí•œ ìœ„ì¹˜ê°€ ê°™ì„ ìˆ˜ ìˆë‹¤.

 ì¶œë ¥
 ì²«ì§¸ ì¤„ì— ë‘ ê²½ì°°ì°¨ê°€ ì´ë™í•œ ì´ ê±°ë¦¬ë¥¼ ì¶œë ¥í•œë‹¤. ë‘˜ì§¸ ì¤„ë¶€í„° ì‹œì‘í•˜ì—¬ (i+1)ë²ˆì§¸ ì¤„ì— i(1 â‰¤ i â‰¤ W)ë²ˆì§¸ ì‚¬ê±´ì´ ë§¡ê²¨ì§„ ê²½ì°°ì°¨ ë²ˆí˜¸ 1 ë˜ëŠ” 2ë¥¼ ì¶œë ¥í•œë‹¤.

 ì˜ˆì œ ì…ë ¥ 1
 6
 3
 3 5
 5 5
 2 3
 
 ì˜ˆì œ ì¶œë ¥ 1
 9
 2
 2
 1
 */
