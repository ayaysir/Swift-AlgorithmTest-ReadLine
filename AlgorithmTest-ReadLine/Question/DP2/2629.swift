//
//  2629.swift
//  AlgorithmTest-ReadLine
//
//  Created by μ¤λ²”νƒ on 3/27/2024.
//
//  4: μ–‘ν”μ €μΈ https://www.acmicpc.net/problem/2629
//

import Foundation

/// μ–‘ν”μ €μΈ https://www.acmicpc.net/problem/2629
/// - 2μ°¨μ› DP λ°°μ—΄: 70212KB    12ms
func Q_2629_() {
        let n = Int(readLine()!)!
        let weights = readLine()!.split(separator: " ").map { Int($0)! }
        let m = Int(readLine()!)!
        let finds = readLine()!.split(separator: " ").map { Int($0)! }
        var dp = Array(repeating: Array(repeating: false, count: 40001), count: 31)
        
        /// countλ²μ§Έ μ¶”λ¥Ό μ¶”κ°€ν–μ„ λ• λ©ν‘ targetλ¥Ό λ§λ“¤ μ μλ”κ°€?
        func recursive(_ count: Int, _ target: Int) {
            if dp[count][target] {
                return
            }
            
            dp[count][target] = true
            
            if count == n {
                return
            }
            
            recursive(count + 1, target)
            recursive(count + 1, target + weights[count])
            recursive(count + 1, abs(target - weights[count]))
        }
        
        recursive(0, 0)
        
        var result = ""
        for i in 0..<m {
            // n: μ¶”μ κ°μ
            // finds[i]: κµ¬μ¬μ λ¬΄κ² ν™•μΈ => μ¶”μ λ¬΄κ² μ°¨μ΄ ν™•μΈ
            result.write(dp[n][finds[i]] ? "Y " : "N ")
        }
        
        print(result)
}

/// μ–‘ν”μ €μΈ https://www.acmicpc.net/problem/2629
/// - 1μ°¨μ› DP λ°°μ—΄: 69108KB    8ms
func Q_2629() {
    let n = Int(readLine()!)!
    let weights = readLine()!.split(separator: " ").map { Int($0)! }
    let weightsMax = weights.reduce(0, +)
    let m = Int(readLine()!)!
    let finds = readLine()!.split(separator: " ").map { Int($0)! }
    var dp = [true] + Array(repeating: false, count: 40001)
    
    for i in stride(from: 0, to: n, by: 1) {
        for j in stride(from: weightsMax, through: 0, by: -1) where dp[j] {
            dp[j + weights[i]] = true
        }
        
        for j in stride(from: 0, through: weightsMax, by: 1) where dp[j] {
            dp[abs(j - weights[i])] = true
        }
    }
    
    var result = ""
    for i in 0..<m {
        // n: μ¶”μ κ°μ
        // finds[i]: κµ¬μ¬μ λ¬΄κ² ν™•μΈ => μ¶”μ λ¬΄κ² μ°¨μ΄ ν™•μΈ
        result.write(dp[finds[i]] ? "Y " : "N ")
    }
    
    print(result)
}


/*
 [ν’€μ΄] https://cobokjang.tistory.com/18
 λ°°λ‚­ μ•κ³ λ¦¬μ¦
 - κµ¬μ¬μ„ λ¬΄μ΅°κ±΄ μ™Όμ½μ— λ‘”λ‹¤κ³  μΉλ©΄,
  (1) μ¶”λ¥Ό μ¬λ¦¬μ§€ μ•λ”λ‹¤.
  (2) μ¶”λ¥Ό μ™Όμ½μ— μ¬λ¦°λ‹¤.
  (3) μ¶”λ¥Ό μ¤λ¥Έμ½μ— μ¬λ¦°λ‹¤. (μ €μΈμ λ°λ€μ½μ— λ†“λ” μ¶”μ λ¬΄κ² κ³„μ‚°μ€ absν•¨μλ¥Ό μ΄μ©ν•΄μ„ μ λ“κ°’κ³„μ‚°μ„ ν–λ‹¤.)
 - 10 20 30 40 50 μ μ¶”κ°€ μλ‹¤κ³  μƒκ°ν•΄λ³΄μ
   - μ¶” 20 | 40 μ΄ μλ” κ²½μ°λ” μ–‘μ½μ μ°¨μ΄κ°€ 20μ΄λ‹¤. -> λ¬΄κ² 20μΈ κµ¬μ¬μ λ¬΄κ² κµ¬ν•  μ μμ
   - μ¶” 10 | 30 μ΄ μλ” κ²½μ°λ” μ—­μ‹ μ–‘μ½μ μ°¨μ΄κ°€ 20μ΄λ‹¤. -> λ¬΄κ² 20μΈ κµ¬μ¬μ λ¬΄κ² κµ¬ν•  μ μμ
   => μ–‘μ½ μ €μΈμ λ¬΄κ²μ°¨μ΄κ°€ κ°™κ³ , μ¶”μ λ¦¬μ¤νΈμ—μ„ νƒμƒ‰ν• indexμ μκ°€ κ°™μΌλ©΄ μ¤‘λ³µλ κ²½μ°μ΄λ‹¤.
        -> λ‚¨μ€ μ¶”μ λ¬΄κ²λ¥Ό μ €μ¥ν• listλ” κ°™κ³  μ–‘μ½ λ¬΄κ² μ°¨μ΄λ„ κ°™κΈ° λ•λ¬Έμ΄λ‹¤.
        -> μ΄ λ¶€λ¶„μ€ μ§„ν–‰μ„ μ•ν•΄λ„ λλ‹¤.
   => dp[μ‚¬μ©ν• μ¶”μ κ°μ][μ¶”μ λ¬΄κ² μ°¨μ΄]
        -> μ‚¬μ©ν• μ¶”μ κ°μλ” λ¬Έμ μ—μ„ μ£Όμ–΄μ§„ nμ΄λ‹¤.
 
 [μ‹¬ν™”] 1μ°¨μ› DP λ°°μ—΄λ΅ μ¤„μ΄κΈ° https://dingcoding.tistory.com/71
 
 --------------------
 
 λ¬Έμ 
 μ–‘ν” μ €μΈκ³Ό λ‡ κ°μ μ¶”κ°€ μ£Όμ–΄μ΅μ„ λ•, μ΄λ¥Ό μ΄μ©ν•μ—¬ μ…λ ¥μΌλ΅ μ£Όμ–΄μ§„ κµ¬μ¬μ λ¬΄κ²λ¥Ό ν™•μΈν•  μ μλ”μ§€λ¥Ό κ²°μ •ν•λ ¤κ³  ν•λ‹¤.

 λ¬΄κ²κ°€ κ°κ° 1gκ³Ό 4gμΈ λ‘ κ°μ μ¶”κ°€ μμ„ κ²½μ°, μ£Όμ–΄μ§„ κµ¬μ¬κ³Ό 1g μ¶” ν•λ‚λ¥Ό μ–‘ν” μ €μΈμ μ–‘μ½μ— κ°κ° μ¬λ ¤λ†“μ•„ μν‰μ„ μ΄λ£¨λ©΄ κµ¬μ¬μ λ¬΄κ²λ” 1gμ΄λ‹¤. λ λ‹¤λ¥Έ κµ¬μ¬μ΄ 4gμΈμ§€λ¥Ό ν™•μΈν•λ ¤λ©΄ 1g μ¶” λ€μ‹  4g μ¶”λ¥Ό μ¬λ ¤λ†“μΌλ©΄ λλ‹¤.

 κµ¬μ¬μ΄ 3gμΈ κ²½μ° μ•„λ <κ·Έλ¦Ό 1>κ³Ό κ°™μ΄ κµ¬μ¬κ³Ό μ¶”λ¥Ό μ¬λ ¤λ†“μΌλ©΄ μ–‘ν” μ €μΈμ΄ μν‰μ„ μ΄λ£¨κ² λλ‹¤. λ”°λΌμ„ κ°κ° 1gκ³Ό 4gμΈ μ¶”κ°€ ν•λ‚μ”© μμ„ κ²½μ° μ£Όμ–΄μ§„ κµ¬μ¬μ΄ 3gμΈμ§€λ„ ν™•μΈν•΄ λ³Ό μ μλ‹¤.
 
 π 1οΈβƒ£ | 4οΈβƒ£
 <κ·Έλ¦Ό 1> κµ¬μ¬μ΄ 3gμΈμ§€ ν™•μΈν•λ” λ°©λ²• (1)μ€ 1gμΈ μ¶”, (4)λ” 4gμΈ μ¶”, β—μ€ λ¬΄κ²λ¥Ό ν™•μΈν•  κµ¬μ¬)
 
 <κ·Έλ¦Ό 2>μ™€ κ°™μ€ λ°©λ²•μ„ μ‚¬μ©ν•λ©΄ κµ¬μ¬μ΄ 5gμΈμ§€λ„ ν™•μΈν•  μ μλ‹¤. κµ¬μ¬μ΄ 2gμ΄λ©΄ μ£Όμ–΄μ§„ μ¶”λ¥Ό κ°€μ§€κ³ λ” ν™•μΈν•  μ μ—†λ‹¤.

 μ¶”λ“¤μ λ¬΄κ²μ™€ ν™•μΈν•  κµ¬μ¬λ“¤μ λ¬΄κ²κ°€ μ…λ ¥λμ—μ„ λ•, μ£Όμ–΄μ§„ μ¶”λ§μ„ μ‚¬μ©ν•μ—¬ κµ¬μ¬μ λ¬΄κ²λ¥Ό ν™•μΈ ν•  μ μλ”μ§€λ¥Ό κ²°μ •ν•λ” ν”„λ΅κ·Έλ¨μ„ μ‘μ„±ν•μ‹μ¤.
 
 π  | 1οΈβƒ£ 4οΈβƒ£
 <κ·Έλ¦Ό 2> κµ¬μ¬μ΄ 5gμΈμ§€ ν™•μΈν•λ” λ°©λ²•
 
 μ…λ ¥
 μ²«μ§Έ μ¤„μ—λ” μ¶”μ κ°μκ°€ μμ—°μλ΅ μ£Όμ–΄μ§„λ‹¤. μ¶”μ κ°μλ” 30 μ΄ν•μ΄λ‹¤. λ‘μ§Έ μ¤„μ—λ” μ¶”μ λ¬΄κ²λ“¤μ΄ μμ—°μλ΅ κ°€λ²Όμ΄ κ²ƒλ¶€ν„° μ°¨λ΅€λ΅ μ£Όμ–΄μ§„λ‹¤. κ°™μ€ λ¬΄κ²μ μ¶”κ°€ μ—¬λ¬ κ° μμ„ μλ„ μλ‹¤. μ¶”μ λ¬΄κ²λ” 500gμ΄ν•μ΄λ©°, μ…λ ¥λλ” λ¬΄κ²λ“¤ μ‚¬μ΄μ—λ” λΉμΉΈμ΄ ν•λ‚μ”© μλ‹¤. μ„Έ λ²μ§Έ μ¤„μ—λ” λ¬΄κ²λ¥Ό ν™•μΈν•κ³ μ ν•λ” κµ¬μ¬λ“¤μ κ°μκ°€ μ£Όμ–΄μ§„λ‹¤. ν™•μΈν•  κµ¬μ¬μ κ°μλ” 7μ΄ν•μ΄λ‹¤. λ„¤ λ²μ§Έ μ¤„μ—λ” ν™•μΈν•κ³ μ ν•λ” κµ¬μ¬λ“¤μ λ¬΄κ²κ°€ μμ—°μλ΅ μ£Όμ–΄μ§€λ©°, μ…λ ¥λλ” λ¬΄κ²λ“¤ μ‚¬μ΄μ—λ” λΉ μΉΈμ΄ ν•λ‚μ”© μλ‹¤. ν™•μΈν•κ³ μ ν•λ” κµ¬μ¬μ λ¬΄κ²λ” 40,000λ³΄λ‹¤ μ‘κ±°λ‚ κ°™μ€ μμ—°μμ΄λ‹¤.

 μ¶λ ¥
 μ£Όμ–΄μ§„ κ° κµ¬μ¬μ λ¬΄κ²μ— λ€ν•μ—¬ ν™•μΈμ΄ κ°€λ¥ν•λ©΄ Y, μ•„λ‹λ©΄ N μ„ μ°¨λ΅€λ΅ μ¶λ ¥ν•λ‹¤. μ¶λ ¥μ€ ν• κ°μ μ¤„λ΅ μ΄λ£¨μ–΄μ§€λ©°, κ° κµ¬μ¬μ— λ€ν• λ‹µ μ‚¬μ΄μ—λ” λΉμΉΈμ„ ν•λ‚μ”© λ‘”λ‹¤.

 μμ  μ…λ ¥ 1
 2
 1 4
 2
 3 2
 μμ  μ¶λ ¥ 1
 Y N
 
 μμ  μ…λ ¥ 2
 4
 2 3 3 3
 3
 1 4 10
 μμ  μ¶λ ¥ 2
 Y Y N
 
 */
